name: stack-media-stalwart

networks:
  my-network-proxy:
    name: my-network-proxy
    external: true

services:
  stalwart:
    image: stalwartlabs/stalwart:v0.12.5-alpine
    restart: no
    hostname: stalwart.media.localhost
    networks:
      - my-network-proxy
    environment:
      - ENV_TMP=false
    volumes:
      - /var/mnt-links/docker/stalwart/opt/stalwart:/opt/stalwart
    expose:
      - 8080
    labels:
      virtual.caddyfile: |
        http://stalwart.media.localhost {
          reverse_proxy http://stalwart:8080 {
          }
        }
      virtual.homefile: |
        <div>
          <a class="shadow" href="http://stalwart.media.localhost">Stalwart (IMAP)</a>
          <small>http://stalwart.media.localhost</small>
        </div>
